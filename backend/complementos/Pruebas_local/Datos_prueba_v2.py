import json
import random

# Función para verificar si un punto está dentro de un polígono
def point_in_polygon(point, polygon):
    x, y = point
    n = len(polygon)
    inside = False
    p1x, p1y = polygon[0]
    for i in range(n + 1):
        p2x, p2y = polygon[i % n]
        if y > min(p1y, p2y):
            if y <= max(p1y, p2y):
                if x <= max(p1x, p2x):
                    if p1y != p2y:
                        xinters = (y - p1y) * (p2x - p1x) / (p2y - p1y) + p1x
                    if p1x == p2x or x <= xinters:
                        inside = not inside
        p1x, p1y = p2x, p2y
    return inside

# Límites del distrito (ejemplo)
district_polygon = [
    [    -17.4109523  , -66.1833351       ],
            [    -17.411074   , -66.1824505      ],
            [    -17.4112762  , -66.1810646       ],
            [    -17.4114013  , -66.1802326       ],
            [    -17.4115648  , -66.1791274       ],
            [   -17.4115786   , -66.179089       ],
            [    -17.4117735  , -66.1790597       ],
            [    -17.4117709  , -66.1790338       ],
            [    -17.4117379  , -66.1787359       ],
            [    -17.4116352  , -66.1776794       ],
            [    -17.4116143  , -66.1775435       ],
            [    -17.4115552  , -66.1773226       ],
            [    -17.4114323  , -66.1770131       ],
            [    -17.4111937  , -66.1764885       ],
            [    -17.410986   , -66.1762112      ],
            [   -17.4108397   , -66.176049       ],
            [    -17.4105887  , -66.1757836       ],
            [    -17.4099274  , -66.1749241       ],
            [    -17.4096444  , -66.1746384       ],
            [    -17.4092079  , -66.1741741       ],
            [    -17.4085633  , -66.1735346       ],
            [    -17.4076849  , -66.1727181       ],
            [    -17.4076109  , -66.1726493       ],
            [    -17.4070305  , -66.1721228       ],
            [    -17.4065527  , -66.1716917       ],
            [    -17.4064045  , -66.1715501       ],
            [    -17.4061922  , -66.1713984       ],
            [   -17.4060807   , -66.171297       ],
            [    -17.405997   , -66.1712268      ],
            [    -17.405824   , -66.1710816      ],
            [    -17.4054318  , -66.1707196       ],
            [    -17.4049669  , -66.1703414       ],
            [    -17.4047986  , -66.1701993       ],
            [    -17.4044761  , -66.1700819       ],
            [    -17.4042511  , -66.1699453       ],
            [   -17.4040564   , -66.169749       ],
            [    -17.4038935  , -66.1696444       ],
            [    -17.4035207  , -66.1694269       ],
            [    -17.4032369  , -66.1693425       ],
            [    -17.402991   , -66.1691621      ],
            [    -17.4028362  , -66.1690926       ],
            [    -17.40266    , -66.1690245     ],
            [    -17.402372   , -66.1689601      ],
            [    -17.4022212  , -66.1688662       ],
            [    -17.4019261  , -66.1688464       ],
            [    -17.4013425  , -66.1687009       ],
            [    -17.4010115  , -66.1686292       ],
            [    -17.400662   , -66.1685981      ],
            [    -17.4001226  , -66.1684875       ],
            [    -17.3998399  , -66.1683696       ],
            [    -17.3996894  , -66.1683174       ],
            [   -17.3996077   , -66.168313       ],
            [   -17.3994214   , -66.168303       ],
            [    -17.3992428  , -66.1682712       ],
            [    -17.3990076  , -66.1682441       ],
            [    -17.3987593  , -66.1681781       ],
            [    -17.3986276  , -66.1681455       ],
            [    -17.3984319  , -66.1681003       ],
            [    -17.3981944  , -66.1680436       ],
            [    -17.3978479  , -66.1679497       ],
            [    -17.3974441  , -66.1678339       ],
            [    -17.396975   , -66.1677207      ],
            [    -17.3963757  , -66.1675895       ],
            [    -17.3955512  , -66.1674169       ],
            [    -17.3947488  , -66.1672882       ],
            [    -17.3940248  , -66.1671376       ],
            [    -17.394061   , -66.1674393      ],
            [    -17.3936679  , -66.1765521       ],
            [    -17.3934951  , -66.1804843       ],
            [    -17.3931114  , -66.1803797       ],
            [    -17.3926605  , -66.1802403       ],
            [    -17.3916723  , -66.1799683       ],
            [    -17.3899446  , -66.1794942       ],
            [    -17.3890965  , -66.1792587       ],
            [   -17.3880011   , -66.178966       ],
            [    -17.3876355  , -66.1788665       ],
            [    -17.3844646  , -66.1770679       ],
            [    -17.3841299  , -66.1768726       ],
            [    -17.3838639  , -66.1767632       ],
            [   -17.3836176   , -66.176686       ],
            [   -17.3834634   , -66.176657       ],
            [    -17.3819782  , -66.1765031       ],
            [    -17.3807605  , -66.1763773       ],
            [    -17.3777511  , -66.1760393       ],
            [    -17.3765277  , -66.1759056       ],
            [   -17.3763814   , -66.175897       ],
            [    -17.3750805  , -66.1758506       ],
            [    -17.374135   , -66.1758335      ],
            [    -17.3733757  , -66.1758028       ],
            [    -17.3725208  , -66.1757597       ],
            [    -17.3716626  , -66.1757515       ],
            [    -17.3712     , -66.1757342    ],
            [    -17.3705699  , -66.1757103       ],
            [    -17.3698104  , -66.1756843       ],
            [    -17.369247   , -66.1756886      ],
            [    -17.3684037  , -66.1757507       ],
            [    -17.3679365  , -66.1757642       ],
            [    -17.3678586  , -66.1757687       ],
            [    -17.36779    , -66.1757672     ],
            [    -17.3676885  , -66.1757477       ],
            [    -17.3675642  , -66.1757163       ],
            [  -17.3671899    , -66.17561       ],
            [    -17.3667876  , -66.1754857       ],
            [    -17.3661067  , -66.1752686       ],
            [   -17.3655119   , -66.175069       ],
            [    -17.3650008  , -66.1767322       ],
            [    -17.3645507  , -66.1782561       ],
            [    -17.3644317  , -66.1786416       ],
            [    -17.3643235  , -66.1788678       ],
            [    -17.3641609  , -66.1791744       ],
            [    -17.3640021  , -66.1794491       ],
            [    -17.3638697  , -66.1796431       ],
            [    -17.363571   , -66.1800179      ],
            [    -17.3632074  , -66.1804917       ],
            [    -17.3630577  , -66.1806761       ],
            [    -17.3629305  , -66.1808145       ],
            [    -17.3626391  , -66.1810864       ],
            [    -17.3624206  , -66.1812741       ],
            [    -17.3621407  , -66.1814905       ],
            [    -17.3617296  , -66.1817567       ],
            [    -17.3613192  , -66.1819989       ],
            [    -17.3610395  , -66.1821526       ],
            [   -17.3600478   , -66.182622       ],
            [    -17.3594799  , -66.1828926       ],
            [    -17.3592797  , -66.1829959       ],
            [    -17.3591697  , -66.1830652       ],
            [    -17.3590376  , -66.1831575       ],
            [    -17.3588019  , -66.1833566       ],
            [    -17.3584306  , -66.1836125       ],
            [    -17.3580127  , -66.1839015       ],
            [    -17.3576914  , -66.1841249       ],
            [  -17.3574348    , -66.18429       ],
            [    -17.3572074  , -66.1844393       ],
            [    -17.3569613  , -66.1846154       ],
            [    -17.3568226  , -66.1847315       ],
            [    -17.3567569  , -66.1847993       ],
            [    -17.3565212  , -66.1850926       ],
            [    -17.3563179  , -66.1853641       ],
            [    -17.355935   , -66.1858592      ],
            [   -17.3557646   , -66.186084       ],
            [    -17.3556042  , -66.1862854       ],
            [    -17.3554051  , -66.1865346       ],
            [    -17.3551943  , -66.1867915       ],
            [  -17.354581     , -66.18762      ],
            [    -17.3538725  , -66.1885303       ],
            [    -17.3535292  , -66.1889559       ],
            [    -17.3524952  , -66.1902644       ],
            [    -17.360631   , -66.1934663      ],
            [    -17.374524   , -66.1982691      ],
            [    -17.3703813  , -66.2070358       ],
            [    -17.379914   , -66.2077117      ],
            [    -17.3800113  , -66.2077493       ],
            [    -17.3800779  , -66.2077546       ],
            [    -17.3805386  , -66.2079102       ],
            [   -17.3806807   , -66.207992       ],
            [   -17.3807541   , -66.208053       ],
            [    -17.3808458  , -66.2081301       ],
            [    -17.3813014  , -66.2084198       ],
            [    -17.3815932  , -66.2085003       ],
            [    -17.3820244  , -66.2084947       ],
            [    -17.3820239  , -66.2084714       ],
            [    -17.3833492  , -66.2081838       ],
            [    -17.3838458  , -66.2081891       ],
            [    -17.3843758  , -66.2082386       ],
            [    -17.3845932  , -66.2082589       ],
            [    -17.3851205  , -66.2082642       ],
            [    -17.3853611  , -66.2082857       ],
            [    -17.3859294  , -66.2082911       ],
            [    -17.3867485  , -66.2083823       ],
            [    -17.388402   , -66.2083608      ],
            [    -17.3885057  , -66.2082951       ],
            [    -17.3886887  , -66.2082776       ],
            [    -17.3886887  , -66.2082481       ],
            [    -17.3887667  , -66.2082522       ],
            [   -17.3887808   , -66.208216       ],
            [    -17.3892646  , -66.2082186       ],
            [    -17.3896306  , -66.2082696       ],
            [    -17.391      , -66.2083152   ],
            [    -17.3922568  , -66.2083018       ],
            [    -17.3952003  , -66.2081945       ],
            [    -17.395876   , -66.2082213      ],
            [    -17.3961422  , -66.2095249       ],
            [    -17.3963264  , -66.2104797       ],
            [    -17.3967155  , -66.2119281       ],
            [    -17.3970533  , -66.2127435       ],
            [   -17.3971949   , -66.213207       ],
            [    -17.3971597  , -66.2143825       ],
            [    -17.3977825  , -66.2149476       ],
            [   -17.3983894   , -66.215384       ],
            [    -17.3996364  , -66.2162529       ],
            [   -17.3996774   , -66.214471       ],
            [    -17.3996873  , -66.2141491       ],
            [    -17.399716   , -66.2132211      ],
            [    -17.3997351  , -66.2126035       ],
            [    -17.3997597  , -66.2118054       ],
            [    -17.3997623  , -66.2117792       ],
            [    -17.3997844  , -66.2105089       ],
            [    -17.3998011  , -66.2098279       ],
            [    -17.3998227  , -66.2091969       ],
            [    -17.3998212  , -66.2087838       ],
            [   -17.3998263   , -66.208564       ],
            [    -17.3998307  , -66.2083759       ],
            [    -17.3998359  , -66.2081904       ],
            [   -17.399843    , -66.207934      ],
            [    -17.3998662  , -66.2076484       ],
            [    -17.3998902  , -66.2071925       ],
            [    -17.3999266  , -66.2059039       ],
            [    -17.3999295  , -66.2058515       ],
            [    -17.3999378  , -66.2054033       ],
            [    -17.3999522  , -66.2048998       ],
            [    -17.3999869  , -66.2037918       ],
            [    -17.400002   , -66.2032525      ],
            [    -17.4000454  , -66.2019292       ],
            [    -17.4001119  , -66.2019382       ],
            [    -17.4001519  , -66.2019418       ],
            [    -17.4001525  , -66.2019148       ],
            [    -17.4001585  , -66.2016693       ],
            [    -17.4001664  , -66.2013423       ],
            [    -17.4002215  , -66.1999404       ],
            [    -17.4002627  , -66.1984393       ],
            [    -17.4003287  , -66.1983546       ],
            [    -17.4003354  , -66.1982569       ],
            [    -17.4003859  , -66.1982681       ],
            [    -17.4006196  , -66.1983318       ],
            [    -17.4017588  , -66.1984675       ],
            [    -17.4028149  , -66.1985842       ],
            [    -17.4029543  , -66.1986035       ],
            [    -17.4030534  , -66.1986158       ],
            [    -17.4042699  , -66.1987413       ],
            [    -17.4045028  , -66.1987653       ],
            [   -17.4045606   , -66.198773       ],
            [    -17.405018   , -66.1988336      ],
            [    -17.4060011  , -66.1989575       ],
            [    -17.4061405  , -66.1990031       ],
            [    -17.4083761  , -66.1992615       ],
            [    -17.4084794  , -66.1992734       ],
            [    -17.4085942  , -66.1992867       ],
            [    -17.4087335  , -66.1993028       ],
            [    -17.4087759  , -66.1993077       ],
            [    -17.4087985  , -66.1993103       ],
            [    -17.4089848  , -66.1993318       ],
            [    -17.4090049  , -66.1992068       ],
            [    -17.4090358  , -66.1990148       ],
            [    -17.4090504  , -66.1989235       ],
            [    -17.4090683  , -66.1988125       ],
            [    -17.4090696  , -66.1988044       ],
            [    -17.4090861  , -66.1987018       ],
            [    -17.4091086  , -66.1985617       ],
            [    -17.4092205  , -66.1978658       ],
            [    -17.4092371  , -66.1977625       ],
            [    -17.4092583  , -66.1976304       ],
            [    -17.4087116  , -66.1975801       ],
            [    -17.4085841  , -66.1975684       ],
            [    -17.4073976  , -66.1974593       ],
            [    -17.4063379  , -66.1973767       ],
            [    -17.4063014  , -66.1973982       ],
            [    -17.4056872  , -66.1973404       ],
            [    -17.4053178  , -66.1973103       ],
            [  -17.4046212    , -66.19726       ],
            [    -17.4039199  , -66.1972031       ],
            [    -17.4034932  , -66.1971523       ],
            [    -17.4034206  , -66.1971199       ],
            [    -17.4033832  , -66.1970807       ],
            [    -17.4033487  , -66.1970491       ],
            [    -17.4032761  , -66.1970166       ],
            [    -17.4025854  , -66.1968884       ],
            [    -17.4019454  , -66.1967626       ],
            [    -17.4012357  , -66.1966372       ],
            [    -17.4004105  , -66.1964902       ],
            [    -17.4002691  , -66.1964576       ],
            [    -17.4004448  , -66.1893625       ],
            [   -17.4004764   , -66.189366       ],
            [    -17.4006154  , -66.1893817       ],
            [    -17.4011413  , -66.1894805       ],
            [    -17.4015922  , -66.1895301       ],
            [    -17.4021784  , -66.1895708       ],
            [    -17.4024435  , -66.1896189       ],
            [    -17.4032856  , -66.1897314       ],
            [    -17.4034342  , -66.1897539       ],
            [    -17.4035538  , -66.1897642       ],
            [    -17.403567   , -66.1897654      ],
            [    -17.4040271  , -66.1898274       ],
            [    -17.4045929  , -66.1899082       ],
            [    -17.4052244  , -66.1899986       ],
            [    -17.4059047  , -66.1900875       ],
            [    -17.4069346  , -66.1902196       ],
            [    -17.4069594  , -66.1902233       ],
            [   -17.4071089   , -66.190245       ],
            [    -17.407253   , -66.1902466      ],
            [    -17.4075075  , -66.1902896       ],
            [    -17.4090596  , -66.1884785       ],
            [    -17.4090612  , -66.1884185       ],
            [    -17.40895    , -66.1882546     ],
            [    -17.408841   , -66.1880938      ],
            [   -17.4087571   , -66.187795       ],
            [    -17.4088236  , -66.1875271       ],
            [    -17.4089111  , -66.1873835       ],
            [    -17.4092953  , -66.1869057       ],
            [   -17.4094733   , -66.186593       ],
            [    -17.4096162  , -66.1863048       ],
            [    -17.4099212  , -66.1859713       ],
            [   -17.4099634   , -66.185911       ],
            [    -17.410132   , -66.1851674      ],
            [    -17.4096892  , -66.1849616       ],
            [    -17.4096025  , -66.1847764       ],
            [    -17.4098433  , -66.1844598       ],
            [    -17.4101388  , -66.1842536       ],
            [    -17.41035    , -66.1842695     ],
            [    -17.4106676  , -66.1845992       ],
            [   -17.4107167   , -66.184671       ],
            [    -17.4107446  , -66.1846641       ],
            [    -17.4109523  , -66.1833351       ]  # El polígono debe cerrarse (primero y último punto iguales)
]

# Encontrar los límites máximos y mínimos para generar puntos dentro de un rectángulo que contenga el polígono
min_lat = min(point[0] for point in district_polygon)
max_lat = max(point[0] for point in district_polygon)
min_lng = min(point[1] for point in district_polygon)
max_lng = max(point[1] for point in district_polygon)

# Generar puntos dentro del polígono
data = []
i = 1
while i <= 1000:  # Cambié a while porque algunos puntos aleatorios pueden caer fuera del polígono
    lat = random.uniform(min_lat, max_lat)
    lng = random.uniform(min_lng, max_lng)
    
    # Verificar si el punto está dentro del polígono
    if point_in_polygon((lat, lng), district_polygon):
        consumo = random.randint(30, 1000)
        data.append({
            "id": str(i),
            "lat": round(lat, 6),
            "lng": round(lng, 6),
            "consumo": consumo
        })
        i += 1

# Guardar como archivo JSON
output_path = "heatmapData_distrito_v2.json"
with open(output_path, "w", encoding="utf-8") as f:
    json.dump(data, f, indent=2)

print(f"Datos guardados en: {output_path}")